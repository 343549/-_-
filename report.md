# Лабораторная работа №1  
## «Снижение размерности музыкальных данных»

---

## 1. Титульный лист

| Параметр                | Значение                                      |
|-------------------------|-----------------------------------------------|
| Учебное заведение       | ИТМО, кафедра Системного анализа и Данных     |
| Дисциплина              | Современные инструменты анализа данных        |
| Лабораторная работа     | №1 — Предобработка, PCA и t-SNE               |
| Студент                 | Джафари Хоссаин                               |
| Группа                  | К3340                                         |
| Преподаватель           | Добренко Наталья Викторовна                   |
| Город, год              | Санкт-Петербург, 2025                         |



---

## 2. Введение

Цель работы — изучить и сравнить методы линейного и нелинейного снижения размерности на реальном датасете музыкальных треков. Основные задачи:

1. Выполнить предобработку и числовое кодирование исходных данных.
2. Исследовать структуру признаков с помощью метода главных компонент (PCA).
3. Построить нелинейные проекции с помощью t-SNE и оценить влияние параметра perplexity.
4. Провести сравнительный анализ методов, сформулировать рекомендации по их использованию.

---

## 3. Исходные данные и предобработка

- **Датасет:** `music_genre.csv`, 50 005 строк, 18 признаков (категориальные и числовые).  
- **Основные этапы предобработки:**
  - Проверка наличия файла и просмотр первых записей.
  - OrdinalEncoding всех категориальных столбцов (`artist_name`, `track_name`, `key`, `mode`, `tempo`, `obtained_date`, `music_genre`) с сохранением отображений в `analysis_outputs/mapping_*.csv`.
  - Удаление признаков с нулевой дисперсией (не обнаружено).
  - Выбор 12 наиболее вариативных признаков и сохранение в `selected_features.csv`.
  - Расчёт корреляционной матрицы и текстовой интерпретации (файл `correlation_interpretation.txt`). Обнаружена значимая отрицательная связь `loudness` ↔ `acousticness` (r ≈ -0.73); остальные корреляции умеренные.

![Корреляционная матрица выбранных признаков](analysis_outputs/correlation_matrix.png)

*Рисунок 1: Корреляционная матрица 12 выбранных признаков. Видна сильная отрицательная корреляция между громкостью и акустичностью.*

---

## 4. PCA: реализация и результаты

### 4.1 График объяснённой дисперсии

- Матрица признаков была стандартизована (`StandardScaler`), затем обучен `PCA()` без ограничения числа компонент.
- Scree-график показывает равномерное снижение вкладов компонент.
- Первые пять компонент объясняют ~54 % дисперсии, первые три — ~38 %.

![Scree plot - объяснённая дисперсия PCA](analysis_outputs/scree_plot.png)

*Рисунок 2: График объяснённой дисперсии для каждой главной компоненты. Видно постепенное убывание вклада компонент.*

### 4.2 Интерпретация компонент

- PC1 в основном сочетает временные и популярностные признаки, PC2 — комбинации текстово-категориальных кодов (жанр, исполнитель).
- Отсутствие единолично доминирующих признаков в первых компонентах указывает на разнородность исходных данных.

### 4.3 Визуализация пространства компонент

- Проекция на PC1–PC2 демонстрирует сглаженное разделение жанров без чётких кластеров.
- Цветовая карта по жанрам подтверждает, что линейное сжатие сохраняет глобальную структуру, но плохо раскрывает локальные группы.

![PCA проекция на первые две компоненты](analysis_outputs/pca_projection_pc1_pc2.png)

*Рисунок 3: Проекция данных на пространство первых двух главных компонент.*

![PCA с раскраской по жанрам](analysis_outputs/pca_colored_by_genre.png)

*Рисунок 4: PCA-проекция с раскраской точек по музыкальным жанрам. Видно общее разделение, но без чётких компактных кластеров.*

---

## 5. t-SNE: реализация и результаты

### 5.1 Визуализации для разных perplexity

- Для ускорения t-SNE использована подвыборка 5 000 объектов (фиксированный `random_state=42`).
- Построены проекции для perplexity {5, 30, 50}.

#### Perplexity = 5

![t-SNE с perplexity = 5](analysis_outputs/tsne_perp_5.png)

*Рисунок 5a: t-SNE проекция с perplexity = 5 (без раскраски по жанрам).*

![t-SNE с perplexity = 5, раскраска по жанрам](analysis_outputs/tsne_perp_5_colored_by_genre.png)

*Рисунок 5b: t-SNE проекция с perplexity = 5, раскраска по жанрам. Видно множество мелких локальных кластеров.*

#### Perplexity = 30

![t-SNE с perplexity = 30](analysis_outputs/tsne_perp_30.png)

*Рисунок 6a: t-SNE проекция с perplexity = 30 (без раскраски по жанрам).*

![t-SNE с perplexity = 30, раскраска по жанрам](analysis_outputs/tsne_perp_30_colored_by_genre.png)

*Рисунок 6b: t-SNE проекция с perplexity = 30, раскраска по жанрам. Оптимальное разделение жанров на устойчивые группы.*

#### Perplexity = 50

![t-SNE с perplexity = 50](analysis_outputs/tsne_perp_50.png)

*Рисунок 7a: t-SNE проекция с perplexity = 50 (без раскраски по жанрам).*

![t-SNE с perplexity = 50, раскраска по жанрам](analysis_outputs/tsne_perp_50_colored_by_genre.png)

*Рисунок 7b: t-SNE проекция с perplexity = 50, раскраска по жанрам. Сглаженные кластеры с частичным смешением жанров.*

### 5.2 Влияние perplexity

- **Perplexity = 5:** множество мелких, шумных кластеров; чувствительность к локальным вариациям.
- **Perplexity = 30:** оптимальный баланс — формируются устойчивые группы по жанрам, сохраняются локальные и глобальные структуры.
- **Perplexity = 50:** сглаживание кластеров, частичное смешение жанров, но всё ещё лучшее разделение, чем в PCA.

---

## 6. Сравнительный анализ PCA и t-SNE

### 6.1 Преимущества и недостатки

| Метод | Преимущества | Недостатки |
|-------|--------------|------------|
| **PCA** | Быстрый, интерпретируемый, даёт упорядоченные компоненты и Scree-анализ; подходит как шаг перед моделированием. | Линейный, плохо выявляет нелинейные кластеры; первые компоненты объясняют лишь ~54 % дисперсии. |
| **t-SNE** | Нелинейный подход, хорошо показывает локальные кластеры жанров, особенно при perplexity ≈ 30. | Требует тонкой настройки perplexity, работает медленнее, плохо масштабируется и не сохраняет глобальные расстояния. |

![Сравнение PCA и t-SNE](analysis_outputs/pca_vs_tsne.png)

*Рисунок 8: Сравнительная визуализация PCA (слева) и t-SNE с perplexity = 30 (справа). Видно, что t-SNE лучше выявляет локальные кластеры жанров.*

### 6.2 Рекомендации

- Использовать **PCA** для:
  - предварительного снижения размерности перед обучением моделей;
  - интерпретации признаков и оценки их значимости.
- Использовать **t-SNE** для:
  - визуализации сложных данных и поиска локальных групп/аномалий;
  - презентации результатов анализа (после возможного предварительного PCA для ускорения).
- Комбинированный подход: сначала сократить размерность PCA (например, до 20 компонент), затем применить t-SNE на этих представлениях.

---

## 7. Выводы

1. Предобработка позволила конвертировать все признаки в числовой формат без потери категориальной информации.
2. PCA показал, что для приемлемого покрытия дисперсии достаточно 5–6 компонент, однако метод не выявил явных кластеров жанров.
3. t-SNE (perplexity 30) чётко разделил музыкальные жанры, демонстрируя превосходство нелинейных методов визуализации для подобных задач.
4. На практике рекомендуется сочетать оба подхода: PCA — для интерпретации и подготовки данных, t-SNE — для визуального анализа и поиска скрытых структур.

Все графики, таблицы и текстовые артефакты сохранены в каталоге `analysis_outputs`.


